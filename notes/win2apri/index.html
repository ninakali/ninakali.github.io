<html>
<style>
img { 
	width: 640px;
	border: 2px; border-style: solid;
	border-color: #888;
	display: block;
	margin-left: auto;
	margin-right: auto;
	image-rendering: pixelated;
	image-rendering: -moz-crisp-edges;
	image-rendering: crisp-edges;
}

body { 
	max-width: 800px; margin:40px auto; font-family: Arial, Helvetica, sans-serif;
	background: lightgrey; padding: 5px;
	border-radius: 5px;
}

h1, h2, h3, h4 {
	padding: 0px 10px 0px 10px;
}

.by {
	margin: -15px 0 0 20px;
	font-style: italic;
}

table {
	border: 1px;
	border-style: solid;
}

th {background-color: #d2d2d2;}

tr:nth-child(even) {background-color: #f2f2f2;}

blockquote {
	font-style: italic;
	color: #555;
}

.cut {
	border: 1px; 
	border-style: solid; 
	border-radius: 5px; 
	border-color: #888; 
	background-color: #E5E5E5; 
	padding: 10px;
}

.post {
	border: 1px; border-style: solid; border-color: #888;
	margin: 5px; padding: 0px 10px 10px 10px;
	border-radius: 5px; background-color: #EEE;
}

.imgdesc {
	text-align: center; color: #555; font-style: italic;
	padding:  0px 10px 10px 10px;
}

.imgfix512 img {
	width: 512px;
	image-rendering: pixelated;
	image-rendering: -moz-crisp-edges;
	image-rendering: crisp-edges;
}

.imgfix720 img {
	width: 720px;
	image-rendering: pixelated;
	image-rendering: -moz-crisp-edges;
	image-rendering: crisp-edges;
}


</style>
<title>Windows 2 for the Apricot PC/Xi</title>
<body><div class="post">
<h1>Windows 2 for the Apricot PC/Xi</h1>
<p class="by">(and Word, and Excel, and so much more) by Nina Kalinina, December 27th, 2025 (rev. 1.00 2025-12-27)</p>
<p>I bought my first Apricot PC about three years ago, when I realised I wanted an 8086-based computer. At the time, I knew nothing about it and simply bought it because it looked rad and the price was low. I had no idea that it was not IBM PC-compatible, and that there were very few programs available for it.</p>
<p>I have been on a quest to get a modern-ish word processor and spreadsheet program for it ever since. Which eventually made me &quot;port&quot; Windows 2 on it. In this post, I will tell you the story of this port.</p>
<p>As a side-quest, I also wrote an <a href="https://ninakalinina.com/notes/win2/">article explaining why Windows 2 is kind of awesome</a>. Make sure to check it out, too, if you need more Windows 2 screenshots in your life.</p>
<p><a href="0000.jpg"><img src="0000.jpg" alt="0000.jpg"></a></p>
<p class="imgdesc">A photograph of a dark grey computer with a CRT monitor - an Apricot PC - running Windows 2</p>
<p>Please note that most of the images in this post were taken from a real green CRT, and thus their quality might vary. You can click the image to load it in full size.</p>
<div class="cut">If you have comments or feedback, please leave them in <a href="https://tech.lgbt/@nina_kali_nina/115792788459542758">the Mastodon thread</a>.
<p>If you own an Apricot PC, or want to try the port in an emulator, check out <a href="https://git.sr.ht/~nkali/win2-apricot">the project on sr.ht</a>. You need an Apricot PC, PC/Xi or Xen with at least 512 kB of RAM.</p>
</div>
<br>
<div class="cut">If you find technical details boring the heck out of you, please don't hesitate to <b>scroll down to the screenshot section</b>.</div>
<hr/><hr/><hr/>
<div class="post">
<h2>A few words about the Apricot PC/Xi</h2>
<p>If you want a personal computer today, your general choice is between a &quot;PC&quot; and a &quot;Mac&quot;. Back in the 1980s, you would have to choose between dozens or even hundreds of computer architectures, and &quot;PC&quot; was not necessarily the most popular choice for a computer. One of the most promising market contenders, Victor 9000, also known as Sirius 1, was released in 1981. It gained popularity in Europe, creating a niche market for &quot;Sirius-compatible&quot; computers. Two years later, the British company ACT released its Sirius-compatible Apricot PC.</p>
<p><a href="0001.jpg"><img src="0001.jpg" alt="0001.jpg"></a></p>
<p class="imgdesc">A photograph of the main board of Apricot PC/Xi, in the process of being washed.</p>
<p>Apricot PC is a delightful computer with a great design. Its heart is Intel 8086, the older sibling of the 8088 used in the IBM PC. It uses lovely 3.5&quot; floppy disks; and it is the first Western computer to have a 3.5&quot; drive - before Apple Macintosh. The screen is 9 inches, 800x400 pixels, with great image fidelity. The PC/Xi model comes with a 10 megabyte Winchester hard drive, British-made Rodime RO352, the first-ever 3.5&quot; hard drive.</p>
<p><a href="0001a.jpg"><img src="0001a.jpg" alt="0001a.jpg"></a></p>
<p class="imgdesc">A photograph of the computer's display showing multiple images at once: photographs of computer chips, schematics, and oscilloscope charts.</p>
<p>The computer is simple enough to be understood by one person in its entirety (over the course of many months of studying). There are schematics, technical manuals, BIOS reference manuals, and example code available for it, too. Its CPU is supported by Microsoft C, Turbo Pascal, and Open Watcom. It even runs MS-DOS (2.0 to 3.20), though, of course, it cannot run any IBM PC programs.</p>
<p>The lack of IBM PC-compatibility proved to be fatal for the Apricot. The entirety of its software catalogue is less than 300 megabytes. There is only one <a href="74ls373.itch.io/where-is-owl">graphical game with a soundtrack</a> for it, and it was made in 2025.</p>
<p>There were, of course, productivity applications for the Apricot, including Microsoft Word for DOS. But among those, only two word processors had a graphical interface: GEM Write and Microsoft Write for Windows 1.</p>
<p><a href="0001b.jpg"><img src="0001b.jpg" alt="0001b.jpg"></a></p>
<p class="imgdesc">A screenshot of Windows 1 Notepad.</p>
<p>Hypothetically, it should be possible to port Windows 3 to this computer. It would require creating Windows 3-compatible <code>SYSTEM.DRV</code>, <code>DISPLAY.DRV</code>, <code>KEYBOARD.DRV</code>, <code>MOUSE.DRV</code>, and ideally <code>COMM.DRV</code> drivers. But that would be a lot of work.</p>
<p>This is where things get interesting. A port of Windows 1 for the Apricot PC (released by ACT in 1987, a year before Windows 2) was miraculously preserved and surfaced online. By itself, Windows 1 is unremarkable, as it does not have much useful software. But its driver architecture is not too different from Windows 2, so I thought it might be just about possible to make Windows 2 for the Apricot. And if I could somehow boot Windows 2, I'd be able to run Word, Excel, and Adobe Illustrator on my Apricot.</p>
<p>Well, it only took two and a half years to pull it off!</p>
</div>
<div class="post">
<h2>Porting Windows 2 on the Apricot</h2>
<h3>Booting, fast and slow</h3>
<p>Even today, software historians are still arguing whether Windows 2.0 deserves to be called a major Windows update. It added dozens of new kernel features, but it barely changed the driver architecture of the system. The mouse and the keyboard drivers for Windows 2 would work fine on Windows 1, and vice versa. The CGA and EGA video drivers from Windows 1 would allow Windows 2 to boot, but could not render the fonts correctly.</p>
<p><a href="0002a.png"><img src="0002a.png" alt="0002a.png"></a></p>
<p class="imgdesc">A screenshot of Windows 2 for IBM PC with a broken video driver; all text on the screen is garbled.</p>
<p>A natural thing to try would be installing Windows 2 with the Apricot drivers for Windows 1. Except that there are no <em>driver files</em>.</p>
<p>When you install Windows 1 or 2 on your computer, the SETUP utility combines (links) the driver files with the kernel. It is called &quot;fast boot&quot; and is supposed to improve the boot times of the system. The result of the SETUP is two files, WIN100.BIN and WIN100.OVL. The BIN file is an EXE file in disguise, consisting of the Windows kernel and the system drivers. The OVL file has resources and code that the system uses only from time to time.</p>
<p>The Windows 1 port of Apricot was only ever distributed with the &quot;fast boot&quot;. The individual driver files were not distributed, so we cannot use them.</p>
<h3>The stub drivers</h3>
<p>If there are no drivers, we can make some! Microsoft has a Driver Development Kit for Windows, also known as Windows DDK. The DDK comes with the drivers for the IBM PC, meant to be used as a reference for other platforms. With the help of the DDK, I implemented a <a href="https://git.sr.ht/~nkali/win2-apricot/commit/51fcc80c4c26867ef7f153618ee4c0970dd735f0#win2stub_dd">stub video driver</a>, and somehow got a stub mouse and system drivers. This was enough to confirm that Windows 2, indeed, can start on the Apricot PC without any patches to the kernel. I had my doubts about that, because Windows 2 comes with EMS memory support, and it might have been using something IBM PC-specific to test for it. Thankfully not.</p>
<p><a href="0002.png"><img src="0002.png" alt="0002.png"></a></p>
<p class="imgdesc">A screenshot of Windows 2 booting in the text mode. The file manager application simply dumps the list of files on the screen, without drawing any windows.</p>
<h3>Trying to write a video driver</h3>
<p>Now I could expand the drivers to support the Apricot PC. Keyboard, mouse, and even system drivers are small and simple. The real beast of a driver is DISPLAY.DRV, as it has to implement a large subset of the Windows graphical subsystem. With the reference display drivers, this should not be a problem, as long as the video card supports a graphical mode.</p>
<p>But the Apricot PC doesn't have a real graphical mode. It has a 50x25 &quot;graphics screen&quot; with a fake 16x16 font. This is a big problem.</p>
<p><a href="0003a.png"><img src="0003a.png" alt="0003a.png"></a></p>
<p class="imgdesc">A page of the Apricot technical reference explaining the organisation of the Video RAM.</p>
<p>The reference video driver from Microsoft makes many bold assumptions about the way video RAM is organised. With the display initialisation routines corrected, the image produced by the reference driver is still undecipherable.</p>
<p><a href="0003.png"><img src="0003.png" alt="0003.png"></a></p>
<p class="imgdesc">A screenshot of the MAME emulator, running Windows 2 on the Apricot. There are no windows, only stripes of black.</p>
<p>Writing a driver for such a video card is significantly more painful than designing a VGA-compatible video card for the Apricot. Maybe I return to <a href="https://git.sr.ht/~nkali/win2-apricot/tree/main/item/Apricot">the Apricot display driver project</a> one day (for the Windows 3.0 port), but for now, I have given up on it.</p>
<h3>Lose the battle, win the war: re-linking</h3>
<p>I decided to abandon the video driver writing when I discovered that video drivers from Windows 1 work correctly in Windows 2 <em>if the system has a font from Windows 1, too</em>. This means if I could somehow extract a video driver from the WIN100.BIN/OVL, I would not need to reverse-engineer it to patch in the font support; it could work out of the box. But how?</p>
<p>The driver files in WIN100 are not &quot;simply concatenated together&quot;: some parts from DISPLAY.DRV ends up in WIN100.BIN, and some in WIN100.OVL. Looking closely at those parts, I realised that the part in WIN100.OVL is identical to the Hercules driver. This gave me an idea: I can get a Hercules video driver; then I could extract CODE and DATA segments along with the Entry Table from the WIN100.BIN, and patch them into the Hercules driver. Unfortunately, not a single NE file format tool supported this use-case. I ended up writing <a href="https://git.sr.ht/~nkali/nexus-relink">my own tool NExus-relink</a> to assist in this process; the tool is still incomplete, but it gave me enough leverage to finish the job manually.</p>
<p>For the video driver, I used a &quot;combine&quot; tool I made for NExus, and then manually patched in the offsets and lengths in the NE header (one for the entry table, two for the segments). Incredibly, this was enough to make Windows 2 happy about the display:</p>
<p><a href="0004.png"><img src="0004.png" alt="0004.png"></a></p>
<p class="imgdesc">A screenshot of Windows 2 running in the MAME emulator.</p>
<p>The same trick worked for the keyboard driver, but the mouse driver gave me a headache. I knew that when the mouse is not found, Windows doesn't display it on the screen, so I kept iterating on the driver, going deeper and deeper. The mouse driver has a relocation table of the OS Fixup type, and there are very few things written about it, so I wasn't sure if the driver was loading correctly.</p>
<p>I confirmed that the interrupt handler of the driver works, and was about to check the kernel source of the corresponding event handler when I discovered that, in fact, the mouse was working fine. It's just that the cursor wasn't displayed on the screen.</p>
<p>In Windows 1/2, the cursor is handled by the video driver to allow hardware acceleration and &quot;hide cursor before taking a screenshot or drawing a bitmap&quot;. So, why is the video driver not drawing the cursor?</p>
<p>Windows DDK documentation has an answer: the mouse cursor drawing routines in the video driver are called by a timer routine, from the SYSTEM.DRV. I told about this to my fiancée, Atsuko, and she said: &quot;Oh, you didn't notice the cursor wasn't blinking?&quot;</p>
<p>Turns out, the timer routines in the SYSTEM.DRV were broken. The SYSTEM.DRV from Windows 1.0 cannot be used with Windows 2, so I implemented <a href="https://git.sr.ht/~nkali/win2-apricot/tree/main/item/System/SOURCE">the Apricot PC <code>SYSTEM.DRV</code></a> using Windows DDK as a reference.</p>
<p>With this driver complete, I had Windows 2 working on my Apricot PC/Xi.</p>
</div>
<div class="post">
<h1>Windows 2 for the Apricot PC: a tour</h1>
<p>Welcome, welcome, let me show you around!</p>
<p><a href="0010.jpg"><img src="0010.jpg" alt="0010.jpg"></a></p>
<p class="imgdesc">I am greeted with the AUG logo when I power up my Apricot. I use the AUG BIOS because it supports the upgraded CPU, NEC V30, much better than the original one. Note that my machine has 896 kB of RAM.</p>
<p><a href="0020.jpg"><img src="0020.jpg" alt="0020.jpg"></a></p>
<p class="imgdesc">The PC/Xi comes with a single 720 kB floppy drive and a 10 MB hard drive. I have MS-DOS 3.20 installed on the hard drive.</p>
<p><a href="0030.jpg"><img src="0030.jpg" alt="0030.jpg"></a></p>
<p class="imgdesc">I have created a file called `win.bat` that simply starts the kernel.</p>
<p><a href="0110.jpg"><img src="0110.jpg" alt="0110.jpg"></a></p>
<p class="imgdesc">Welcome to Windows 2. I have GW Basic, Turbo Pascal, Windows 1, Windows 2, Word and Excel installed on the hard drive, and I still have almost 2 megabytes free.</p>
<p><a href="0201.jpg"><img src="0201.jpg" alt="0201.jpg"></a></p>
<p class="imgdesc">PC Paintbrush is one of the few programs that work on both Windows 1 and Windows 2. But it is more stable when running on top of Windows 2. Note that this is not Microsoft Paint (yet).</p>
<p><a href="0202.jpg"><img src="0202.jpg" alt="0202.jpg"></a></p>
<p class="imgdesc">I have to remind you that the screen is <em>monochrome</em>. Pixel dithering works really well on a 100 PPI 800x400 display, creating shades of grey from pixel patterns.</p>
<p><a href="0210.jpg"><img src="0210.jpg" alt="0210.jpg"></a></p>
<p class="imgdesc">The screen is 4:3, so the pixels are not square. I have to pre-process raster images so they would look right on the Apricot's screen. Vector images are fine, though.</p>
<p><a href="0310.jpg"><img src="0310.jpg" alt="0310.jpg"></a></p>
<p class="imgdesc">The default shell for Windows 2 is a bit too minimalistic to my taste. WANG's ClearView for Windows 2 brings a familiar to Windows 3 users PROGMAN-like experience to the Apricot.</p>
<p><a href="0320.jpg"><img src="0320.jpg" alt="0320.jpg"></a></p>
<p class="imgdesc">Windows 1 came with tiling windows; Windows 2 uses overlapping windows that quickly become a disorganised mess. ClearView's window manager can arrange the windows for you.</p>
<p><a href="0330.jpg"><img src="0330.jpg" alt="0330.jpg"></a></p>
<p class="imgdesc">Windows 2 control panel looks a bit funny in monochrome, but it is a powerful reminder that Windows supports 24-bit colour, which is important for printing and publishing.</p>
<p><a href="0410.jpg"><img src="0410.jpg" alt="0410.jpg"></a></p>
<p class="imgdesc">A side note: Apricot's keyboard had an LED in the logo before ThinkPad did.</p>
<p><a href="0420.jpg"><img src="0420.jpg" alt="0420.jpg"></a></p>
<p class="imgdesc">The MicroScreen and re-programmable keys are fully supported by the Windows keyboard driver. There is no ALT key, so "Close" is as close as we can get to pressing ALT+f4. Note that there is a hotkey for starting the XENTEL telephone accessory. The XENTEL button is somewhat similar to a Copilot button, except it can actually be useful in some situations.</p>
<p><a href="0510.jpg"><img src="0510.jpg" alt="0510.jpg"></a></p>
<p class="imgdesc">Microsoft Word for Windows. Word for DOS, a completely different program, was first released back in 1983. Word for Windows had its first release in late 1989 due to a non-competition agreement with Apple. The success of Word for Windows made Microsoft abandon Word for DOS and Word for Mac; all the new versions of Word were based on <em>this</em> Word.</p>
<p><a href="0520.jpg"><img src="0520.jpg" alt="0520.jpg"></a></p>
<p class="imgdesc">Word for Windows is surprisingly powerful for a brand-new product. There is a spellchecker, a page layout editor, and even support for macros. I have deleted the macros to save space on the hard drive, so the README file shows "Error!" where the macros were. The files created by Word for Windows 1.0 can be opened by modern office suites if you save as RTF.</p>
<p><a href="0610.jpg"><img src="0610.jpg" alt="0610.jpg"></a></p>
<p class="imgdesc">Microsoft Excel is a real deal-breaker. There is no other spreadsheet as powerful as Excel on the Apricot.</p>
<p><a href="0620.jpg"><img src="0620.jpg" alt="0620.jpg"></a></p>
<p class="imgdesc">Excel for Windows from 1988 looks almost exactly like Excel for Windows from 2018.</p>
<p><a href="0630.jpg"><img src="0630.jpg" alt="0630.jpg"></a></p>
<p class="imgdesc">My previous trip to Japan was planned between Google Docs and Excel for Windows 2 (I had to convert the file back and forth). I needed a few GB of RAM for Google Docs, and only a few hundred kilobytes for Excel.</p>
<p><a href="0640.jpg"><img src="0640.jpg" alt="0640.jpg"></a></p>
<p class="imgdesc">Excel Help is a hidden gem. It is a hypertext application that feels a lot like a web browser.</p>
<p><a href="0650.jpg"><img src="0650.jpg" alt="0650.jpg"></a></p>
<p class="imgdesc">I used the Help application to see how to create a stonks chart.</p>
<p><a href="0670.jpg"><img src="0670.jpg" alt="0670.jpg"></a></p>
<p class="imgdesc">Creating a stonks chart is surprisingly easy. There are 44 chart types, more than many modern programs offer.</p>
<p><a href="0710.jpg"><img src="0710.jpg" alt="0710.jpg"></a></p>
<p class="imgdesc">Until yesterday, Apricot PC had five graphical games: Chess, Where Is The Owl, Windows 1 Reversi, Windows 1 Minesweeper, and Windows 1 Risk. Now there are many more, including a solitaire and a Taipei mahjongg.</p>
<p><a href="0810.jpg"><img src="0810.jpg" alt="0810.jpg"></a></p>
<p class="imgdesc">That's it! There are many Windows 2 programs I have yet to try on the Apricot, but my quest for running modern-ish Word and Excel for Windows is finally over.</p>
</div>
<hr/><hr/><hr/>
<div class="post">
<h2>Acknowledgments</h2>
<ul>
<li>Thank you for reading! If you have any questions or comments, please let me know. You can leave a comment in the <a href="https://tech.lgbt/@nina_kali_nina/115792788459542758">Mastodon thread about this article</a>.</li>
<li>My fiancée not only helped with beta-testing, she even designed a RAM expansion board for the Apricot PC/Xi that was necessary to run Windows on it. Love~</li>
<li>This project could not exist without advice from Michal Necasek of <a href="https://www.os2museum.com/wp/author/michaln/">os2museum</a> and David Simunič of <a href="https://win1.krnl386.com/about.php">krnl386</a> regarding drivers for ancient Windows version.</li>
</ul>
</div>
<hr/><hr/><hr/>
